if (self.CavalryLogger) { CavalryLogger.start_js(["ZcptK"]); }

__d('concatArrayBuffer',[],(function a(b,c,d,e,f,g){'use strict';var h=function i(j,k){var l=new Uint8Array(j.byteLength+k.byteLength);l.set(new Uint8Array(j),0);l.set(new Uint8Array(k),j.byteLength);return l.buffer};f.exports=h}),null);
__d('MaybeNativePromise',['Promise'],(function a(b,c,d,e,f,g){'use strict';var h=b.Promise||c('Promise');c('Promise').resolve();f.exports=h}),null);
__d('DeferredBuffer',['invariant','Deferred','MaybeNativePromise'],(function a(b,c,d,e,f,g,h){'use strict';function i(){this.$DeferredBuffer1=[];this.$DeferredBuffer2=false}i.prototype.produce=function(j){this.$DeferredBuffer1.push(j);if(this.$DeferredBuffer3)this.$DeferredBuffer3.resolve();};i.prototype.consume=function(j){if(this.$DeferredBuffer2)throw new Error('A buffer can only be consumed by one client at a time');this.$DeferredBuffer2=true;var k=c('MaybeNativePromise').resolve();if(!this.$DeferredBuffer1.length){this.$DeferredBuffer3=new (c('Deferred'))();k=this.$DeferredBuffer3.getPromise()}return k.then(function(){this.$DeferredBuffer1.length>0||h(0);this.$DeferredBuffer3=null;this.$DeferredBuffer2=false;return this.$DeferredBuffer4(j)}.bind(this))};i.prototype.$DeferredBuffer4=function(j){if(this.$DeferredBuffer1.length===0)return new Uint8Array([]);var k=this.$DeferredBuffer1[0];if(j!==undefined&&k.length>j){var l=k.slice(j);k=k.slice(0,j);this.$DeferredBuffer1[0]=l}else this.$DeferredBuffer1.shift();return k};i.prototype.isEmpty=function(){return this.$DeferredBuffer1.length===0};f.exports=i}),null);
__d('FetchStreamStateTracker',['invariant'],(function a(b,c,d,e,f,g,h){'use strict';i.prototype.setNextRequestInfo=function(j){this.$FetchStreamStateTracker1=this.$FetchStreamStateTracker2;this.$FetchStreamStateTracker2=j};i.prototype.setFetchRange=function(j){this.$FetchStreamStateTracker3=j};i.prototype.isNextRequestContinuous=function(){this.$FetchStreamStateTracker2||h(0);if(!this.$FetchStreamStateTracker1)return false;if(this.$FetchStreamStateTracker1.baseUrl!==this.$FetchStreamStateTracker2.baseUrl||this.$FetchStreamStateTracker1.endByte+1!==this.$FetchStreamStateTracker2.startByte)return false;return true};i.prototype.isNextRequestInRange=function(){this.$FetchStreamStateTracker2||h(0);if(!this.$FetchStreamStateTracker3)return false;return (this.$FetchStreamStateTracker2.endByte||0)<=this.$FetchStreamStateTracker3.endByte};function i(){}f.exports=i}),null);
__d("ReadableStream",[],(function a(b,c,d,e,f,g){f.exports=window.ReadableStream}),null);
__d("WritableStream",[],(function a(b,c,d,e,f,g){f.exports=window.WritableStream}),null);
__d('FixedSizeTransform',['invariant','Deferred','DeferredBuffer','MaybeNativePromise','ReadableStream','WritableStream','pipeErrorTo'],(function a(b,c,d,e,f,g,h){'use strict';function i(){this.$FixedSizeTransform2=new (c('DeferredBuffer'))();this.$FixedSizeTransform3=0;this.$FixedSizeTransform4=c('MaybeNativePromise').resolve();this.$FixedSizeTransform6=[]}i.prototype.getSink=function(){if(!this.$FixedSizeTransform1)this.$FixedSizeTransform1=new (c('WritableStream'))({start:function(j){this.$FixedSizeTransform5=j}.bind(this),write:function(j){j instanceof Uint8Array||h(0);this.$FixedSizeTransform2.produce(j)}.bind(this),close:function(){this.$FixedSizeTransform1=null}.bind(this),abort:function(j){this.$FixedSizeTransform6.forEach(function(k){c('pipeErrorTo')(k,j)})}.bind(this)});return this.$FixedSizeTransform1};i.prototype.getNextFixedSizeStream=function(j){var k=new (c('Deferred'))(c('MaybeNativePromise')),l=k.getPromise(),m=this.$FixedSizeTransform4;this.$FixedSizeTransform4=l;return c('MaybeNativePromise').resolve(new (c('ReadableStream'))({start:function(n){this.$FixedSizeTransform6.push(n)}.bind(this),pull:function(n){return m.then(function(){if(this.$FixedSizeTransform3===j){n.close();this.$FixedSizeTransform3=0;k.resolve();return c('MaybeNativePromise').resolve()}var o=j-this.$FixedSizeTransform3;return this.$FixedSizeTransform2.consume(o).then(function(p){n.enqueue(p);this.$FixedSizeTransform3+=p.length}.bind(this))}.bind(this))}.bind(this),cancel:function(n){c('pipeErrorTo')(this.$FixedSizeTransform5,n)}.bind(this)}))};f.exports=i}),null);
__d('PausableRangeStream',['MaybeNativePromise','DeferredBuffer','ReadableStream','WritableStream','pipeErrorTo'],(function a(b,c,d,e,f,g){'use strict';function h(){return new Error('Upstream has an inconsistent range')}function i(j,k){this.$PausableRangeStream3=new (c('DeferredBuffer'))();this.$PausableRangeStream7=0;this.$PausableRangeStream8=0;this.$PausableRangeStream1=j;this.$PausableRangeStream2=k;this.$PausableRangeStream6=new (c('ReadableStream'))({start:function(l){this.$PausableRangeStream11=l}.bind(this),pull:function(l){var m=this.$PausableRangeStream1.endByte-this.$PausableRangeStream1.startByte+1;if(this.$PausableRangeStream7===m&&this.$PausableRangeStream3.isEmpty()){l.close();return c('MaybeNativePromise').resolve()}return this.$PausableRangeStream3.consume().then(function(n){this.$PausableRangeStream7+=n.length;if(this.$PausableRangeStream7>m)c('pipeErrorTo')(this.$PausableRangeStream11,h());l.enqueue(n)}.bind(this))}.bind(this),cancel:function(l){c('pipeErrorTo')(this.$PausableRangeStream10,l)}.bind(this)});this.$PausableRangeStream12()}i.prototype.$PausableRangeStream12=function(){this.$PausableRangeStream4=new (c('WritableStream'))({start:function(j){this.$PausableRangeStream10=j}.bind(this),write:function(j){this.$PausableRangeStream3.produce(j);this.$PausableRangeStream8+=j.length}.bind(this),close:function(){if(this.$PausableRangeStream8!==this.$PausableRangeStream1.endByte-this.$PausableRangeStream1.startByte+1)c('pipeErrorTo')(this.$PausableRangeStream11,h());}.bind(this),abort:function(j){c('pipeErrorTo')(this.$PausableRangeStream11,j)}.bind(this)})};i.prototype.getStream=function(){return this.$PausableRangeStream6};i.prototype.startStream=function(){var j=this.$PausableRangeStream1;j.startByte+=this.$PausableRangeStream8;return this.$PausableRangeStream2.startStream(j).then(function(k){this.$PausableRangeStream5=k;this.$PausableRangeStream9=k.pipeTo(this.$PausableRangeStream4)}.bind(this))};i.prototype.pauseStream=function(){c('pipeErrorTo')(this.$PausableRangeStream10,'streamPaused');this.$PausableRangeStream12();return c('MaybeNativePromise').resolve()};f.exports=i}),null);
__d('VideoSegmentStreamByFetch',['invariant','ReadableStream','VideoSegmentInfoHelper'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('ReadableStream').ReadableStream;function j(k){this.$VideoSegmentStreamByFetch1=k}j.prototype.startStream=function(k){window.fetch||h(0);var l={baseUrl:this.$VideoSegmentStreamByFetch1,startByte:k.startByte,endByte:k.endByte},m=c('VideoSegmentInfoHelper').getRequestUri(l);return window.fetch(m.toString()).then(function(n){var o=n.body;o.getReader||h(0);return o})};f.exports=j}),null);
__d('VideoStreamingManager',['invariant','EventEmitter','FetchStreamStateTracker','FixedSizeTransform','MaybeNativePromise','PausableRangeStream','StreamBandwidthReporter','VideoSegmentStreamByFetch'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;i=babelHelpers.inherits(k,c('EventEmitter'));j=i&&i.prototype;function k(l){j.constructor.call(this);this.$VideoStreamingManager7=c('MaybeNativePromise').resolve();this.$VideoStreamingManager6=new (c('FetchStreamStateTracker'))();this.$VideoStreamingManager4=l}k.prototype.getStream=function(l){var m=l.startByte,n=l.endByte;m!==undefined&&n!==undefined||h(0);var o=this.$VideoStreamingManager7;return o.then(function(){this.$VideoStreamingManager8(l)}.bind(this)).then(function(){return this.$VideoStreamingManager2.getNextFixedSizeStream(n-m+1)}.bind(this))};k.prototype.$VideoStreamingManager8=function(l){this.$VideoStreamingManager6.setNextRequestInfo(l);if(!this.$VideoStreamingManager6.isNextRequestContinuous()||!this.$VideoStreamingManager6.isNextRequestInRange()){this.$VideoStreamingManager3=this.$VideoStreamingManager9(new (c('VideoSegmentStreamByFetch'))(l.baseUrl));var m=this.$VideoStreamingManager4.getFetchRange(l);this.$VideoStreamingManager6.setFetchRange(m);this.$VideoStreamingManager1=new (c('PausableRangeStream'))(m,this.$VideoStreamingManager3);this.$VideoStreamingManager2=new (c('FixedSizeTransform'))();this.$VideoStreamingManager1.startStream();this.$VideoStreamingManager7=this.$VideoStreamingManager1.getStream().pipeTo(this.$VideoStreamingManager2.getSink())['catch'](function(n){this.$VideoStreamingManager10()}.bind(this))}};k.prototype.$VideoStreamingManager9=function(l){var m={startStream:function(n){var o=new (c('StreamBandwidthReporter'))();o.addListener('bandwidthUpdate',function(p){return this.emit('bandwidthUpdate',p)}.bind(this));return l.startStream(n).then(function(p){return p.pipeThrough(o)})}.bind(this)};return m};k.prototype.$VideoStreamingManager10=function(){this.$VideoStreamingManager6=new (c('FetchStreamStateTracker'))()};f.exports=k}),null);